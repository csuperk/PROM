<div class="form-container">
  <!-- 工具列 -->
  <ng-container *ngIf="showToolbar">
    <p-toolbar>
      <div class="p-toolbar-group-left">
        <ng-container *ngFor="let btn of toolBarButtons">
          <button
            pButton
            style="margin-left: 10px"
            icon="{{ btn.icon }}"
            type="button"
            label="{{ btn.title }}"
            class="{{ btn.class }}"
            [hidden]="btn.displayNone"
            [disabled]="btn.disable || displayProgress"
            (click)="btn.onClick()">
          </button>
        </ng-container>
      </div>
    </p-toolbar>
  </ng-container>

  <!-- 表單資訊標籤 -->
  <ng-container *ngIf="showTag && tmplInfo.tmplNo">
    <div class="form-info-tags" style="margin: 10px 0;">
      <p-tag
        icon="pi pi-info-circle"
        value="表單編號: {{ tmplInfo.tmplNo }}"
        severity="info">
      </p-tag>
      <p-tag
        icon="pi pi-file"
        value="表單名稱: {{ tmplInfo.formName || '表單填寫' }}"
        severity="success">
      </p-tag>
    </div>
  </ng-container>

  <!-- Form.io 表單 -->
  <div class="form-content" style="min-height: 400px;">
    <formio
      #formIo
      [form]="tmplInfo.formTmpl"
      [submission]="submitData"
      [readOnly]="formReadOnly"
      [refresh]="triggerRefresh"
      (change)="onChange($event)">
    </formio>
  </div>

  <!-- 進度顯示 -->
  <p-dialog
    header="處理中"
    [(visible)]="displayProgress"
    [modal]="true"
    [closable]="false"
    [resizable]="false"
    [draggable]="false"
    styleClass="progress-dialog">
    <div class="progress-content" style="text-align: center; padding: 20px;">
      <p-progressSpinner></p-progressSpinner>
      <p style="margin-top: 10px;">請稍候...</p>
    </div>
  </p-dialog>

  <!-- 訊息顯示 -->
  <p-toast key="generalFormReplyMessage" position="top-center"></p-toast>
</div>
